<?php include("conexao.php"); ?>
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Adicionar Colaborador</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/cadastroColaboradores.css">
</head>
<body>
    <header class="topbar">
        <div class="logo"><img src="img/rhease-ease 1.png" alt="Logo RH Ease" class="logo"></div>
    </header>

    <main class="form-container">
        <h2 style="color: #25621C; font-weight: 600;">Adicionar Colaborador</h2>
        <form action="processa.php" method="POST">

            <!--dados pessoais-->
            <section>
                <h3>1. Dados Pessoais</h3>
                <div class="grid">
                    <div><label>Nome completo</label><input type="text" name="nome" placeholder="Ex.: Maria Oliveira da Silva" required></div>
                    <div><label>CPF</label><input type="text" name="cpf" placeholder="999.999.999-99" required oninput="mascaraCPF(this)"></div>
                    <div><label>RG</label><input type="text" name="rg"></div>
                    <div><label>Data de nascimento</label><input type="date" name="data_nascimento" required></div>
                    <div>
                        <label>Gênero</label>
                        <select name="genero">
                            <option value="">Selecione</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Outro">Outro</option>
                            <option value="Prefiro não informar">Prefiro não informar</option>
                        </select>
                    </div>
                    <div><label>E-mail</label><input type="email" name="email" placeholder="exemplo@gmail.com" required></div>
                    <div><label>Telefone celular</label><input type="text" name="telefone" placeholder="(99) 99999-9999" oninput="mascaraTelefone(this)"></div>
                </div>
            </section>

            <!--endereço-->
            <section>
                <h3>2. Endereço</h3>
                <div class="grid">
                    <div><label>CEP</label><input type="text" name="cep" placeholder="99999-999" oninput="mascaraCEP(this)" onblur="buscaCEP(this.value)"></div>
                    <div class="col-2"><label>Logradouro</label><input type="text" name="logradouro" placeholder="Rua, Avenida, Travessa etc."></div>
                    <div><label>Número</label><input type="text" name="numero" placeholder="Ex.: 123"></div>
                    <div><label>Complemento</label><input type="text" name="complemento" placeholder="Ex.: Apt 202, Bloco B"></div>
                    <div><label>Bairro</label><input type="text" name="bairro" placeholder="Ex.: Centro"></div>
                    <div><label>Cidade</label><input type="text" name="cidade" placeholder="Ex.: Palmas"></div>
                    <div>
                        <label>Estado (UF)</label>
                        <select name="estado">
                            <option value="">Selecione</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                </div>
            </section>

            <!--dados profissionais-->
            <section>
                <h3>3. Dados Profissionais</h3>
                <div class="grid">
                    <div><label>ID (Matrícula)</label><input type="text" name="matricula" placeholder="99999-999"></div>
                    <div><label>Cargo</label><input type="text" name="cargo" placeholder="Ex.: Analista de Sistemas" required></div>
                    <div><label>Departamento</label><input type="text" name="departamento" placeholder="Ex.: TI, Financeiro" required></div>
                    <div><label>Salário (R$)</label><input type="text" name="salario" placeholder="Ex.: 3.500,75" required></div>
                    <div><label>Data de Admissão</label><input type="date" name="data_admissao" required></div>
                    <div>
                        <label>Tipo de Contrato</label>
                        <select name="tipo_contrato" required>
                            <option value="">Selecione</option>
                            <option value="CLT">CLT</option>
                            <option value="PJ">PJ</option>
                            <option value="Estágio">Estágio</option>
                            <option value="Temporário">Temporário</option>
                        </select>
                    </div>
                    <div><label>E-mail Corporativo</label><input type="email" name="email_corporativo" placeholder="usuario@empresa.com"></div>
                </div>
            </section>

            <div class="btn-area">
                <button type="submit">Salvar Mudanças</button>
            </div>
        </form>
    </main>
    <script>
        // Máscara CPF
        function mascaraCPF(i){
            let v = i.value.replace(/\D/g,'');
            v = v.replace(/(\d{3})(\d)/,'$1.$2');
            v = v.replace(/(\d{3})(\d)/,'$1.$2');
            v = v.replace(/(\d{3})(\d{1,2})$/,'$1-$2');
            i.value = v;
        }

        // Máscara Telefone
        function mascaraTelefone(i){
            let v = i.value.replace(/\D/g,'');
            if(v.length <= 10){
                v = v.replace(/(\d{2})(\d)/,'($1) $2');
                v = v.replace(/(\d{4})(\d)/,'$1-$2');
            } else {
                v = v.replace(/(\d{2})(\d)/,'($1) $2');
                v = v.replace(/(\d{5})(\d)/,'$1-$2');
            }
            i.value = v;
        }

        // Máscara CEP
        function mascaraCEP(i){
            let v = i.value.replace(/\D/g,'');
            v = v.replace(/(\d{5})(\d)/,'$1-$2');
            i.value = v;
        }

        // Preenchimento automático de endereço via CEP
        async function buscaCEP(cep){
            cep = cep.replace(/\D/g,'');
            if(cep.length === 8){
                try{
                    const res = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await res.json();
                    if(!data.erro){
                        document.querySelector('input[name="logradouro"]').value = data.logradouro;
                        document.querySelector('input[name="bairro"]').value = data.bairro;
                        document.querySelector('input[name="cidade"]').value = data.localidade;
                        document.querySelector('select[name="estado"]').value = data.uf;
                    } else {
                        alert("CEP não encontrado.");
                    }
                } catch(e){
                    alert("Erro ao buscar CEP.");
                }
            }
        }
    </script>
</body>
</html>
